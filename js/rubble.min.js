function preload(){game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,game.scale.pageAlignHorizontally=!0,game.scale.pageAlignVertically=!0,game.stage.backgroundColor="#eee",game.load.image("ball","assets/ball.png"),game.load.image("paddle","assets/paddle.png"),game.load.image("brick","assets/brick.png"),game.load.spritesheet("ball","assets/wobble.png",20,20),game.load.spritesheet("button","assets/button.png",120,40)}function create(){ball=game.add.sprite(game.world.centerX,game.world.centerY,"ball"),ball.animations.add("wobble",[0,1,0,2,0,1,0,2,0],24),paddle=game.add.sprite(game.world.centerX,game.world.height-5,"paddle"),paddleHalfWidth=paddle.width/2,startButton=game.add.button(game.world.centerX,game.world.centerY,"button",startGame,this,1,0,2),startButton.anchor.set(.5),game.physics.startSystem(Phaser.Physics.ARCADE),game.physics.enable(ball,Phaser.Physics.ARCADE),game.physics.enable(paddle,Phaser.Physics.ARCADE),game.physics.arcade.checkCollision.down=!1,ball.body.collideWorldBounds=!0,ball.body.bounce.set(1),ball.checkWorldBounds=!0,ball.events.onOutOfBounds.add(ballLeaveScreen,this),paddle.anchor.set(.5,1),paddle.body.immovable=!0,initBricks(),scoreText=game.add.text(5,5,"Points: 0",textStyle),livesText=game.add.text(game.world.width-5,5,"Lives: "+lives,textStyle),livesText.anchor.set(1,0),lifeLostText=game.add.text(game.world.centerX,game.world.centerY,"Life lost, click to continue",textStyle),lifeLostText.anchor.set(.5),lifeLostText.visible=!1}function update(){playing&&(paddle.x=game.input.x),paddleUpdate(paddle),game.physics.arcade.collide(ball,paddle,ballHitPaddle),game.physics.arcade.collide(ball,bricks,ballHitBrick)}function initBricks(){for(brickInfo={width:50,height:20,count:{row:7,col:3},offset:{top:50,left:60},padding:10},bricks=game.add.group(),c=0;c<brickInfo.count.col;c++)for(r=0;r<brickInfo.count.row;r++){var e=r*(brickInfo.width+brickInfo.padding)+brickInfo.offset.left,a=c*(brickInfo.height+brickInfo.padding)+brickInfo.offset.top;newBrick=game.add.sprite(e,a,"brick"),game.physics.enable(newBrick,Phaser.Physics.ARCADE),newBrick.body.immovable=!0,newBrick.anchor.set(.5),bricks.add(newBrick)}}function ballHitBrick(e,a){var t=game.add.tween(a.scale).to({x:0,y:0},200,Phaser.Easing.Linear.None);t.onComplete.addOnce(function(){a.kill()},this),t.start(),score+=10,scoreText.setText("Points: "+score),score===brickInfo.count.row*brickInfo.count.col*10&&(alert("You won the game, congratulations!"),location.reload())}function ballLeaveScreen(){lives--,lives?(livesText.setText("Lives: "+lives),lifeLostText.visible=!0,ball.reset(game.world.centerX-9,.6*game.world.height),paddle.reset(game.world.centerX,game.world.height-5),game.input.onDown.addOnce(function(){lifeLostText.visible=!1,ball.body.velocity.set(150,-150)},this)):(alert("You lost, game over!"),location.reload())}function ballHitPaddle(e,a){e.animations.play("wobble"),e.body.velocity.x=-5*(a.x-e.x)}function startGame(){startButton.destroy(),ball.body.velocity.set(150,-150),playing=!0}function paddleUpdate(e){e.x<paddleHalfWidth?e.x=paddleHalfWidth:e.x>game.world.width-paddleHalfWidth&&(e.x=game.world.width-paddleHalfWidth)}var game=new Phaser.Game(480,360,Phaser.AUTO,null,{preload:preload,create:create,update:update}),ball,paddle,paddleHalfWidth,bricks,newBrick,brickInfo,scoreText,score=0,lives=3,livesText,lifeLostText,textStyle={font:"18px Arial",fill:"#0095DD"},playing=!1,startButton;
